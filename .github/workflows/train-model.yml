name: Train Custom TTS Model (Docker)

on:
  workflow_dispatch:

jobs:
  train:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
    # Step 1: Repository ka code (audio file, script) download karna
    - name: Checkout repository
      uses: actions/checkout@v4

    # Step 2: Docker ke andar training chalana (THE CORRECT WAY)
    - name: Run Training in Docker Container
      run: |
        # --entrypoint "/bin/bash": Docker container ke andar 'bash' shell shuru karo.
        # -c "python3 ...": 'bash' shell ko hukum do ke woh 'python3' ka istemal karke script chalaye.
        docker run --rm -v $(pwd):/root/training --entrypoint "/bin/bash" ghcr.io/coqui-ai/tts:latest -c "python3 /root/training/train_tts.py"

    # Step 3: Trained model ko Artifacts mein upload karna
    - name: Upload Trained Model
      uses: actions/upload-artifact@v4
      with:
        name: trained-tts-model
        path: trained_model_output/
